<!DOCTYPE html>
<html dir="rtl" lang="ku">
<head>
    <meta charset="UTF-8">
    <title>Aviatrix Ultra Pro</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <style>
        :root { --main-red: #ea1d5d; --bg-dark: #0f1218; --panel: #1b1f28; }
        body { margin: 0; background: var(--bg-dark); color: white; font-family: 'Inter', sans-serif; overflow: hidden; height: 100vh; }
        
        /* Ø´Ø§Ø´Û•ÛŒ ÛŒØ§Ø±ÛŒÛŒÛ•Ú©Û• Ú•ÛÚ© ÙˆÛ•Ú© ÙˆÛ•Ø´Ø§Ù†ÛŒ ÙÛ•Ø±Ù…ÛŒ */
        .game-wrapper { display: flex; flex-direction: column; height: 100%; }
        .header { padding: 15px 25px; background: var(--panel); display: flex; justify-content: space-between; border-bottom: 2px solid var(--main-red); }
        
        .main-stage { flex-grow: 1; position: relative; background-image: 
            linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
            linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px);
            background-size: 50px 50px; /* Ø¦Û•Ù…Û• Ú¯Ø±ÛŒØ¯ÛŒ Ù¾Ø´ØªÛ•ÙˆÛ•ÛŒÛ• */
            overflow: hidden;
        }

        #multiplier { position: absolute; top: 30%; left: 50%; transform: translateX(-50%); font-size: 80px; font-weight: 800; z-index: 10; text-shadow: 0 0 30px rgba(234, 29, 93, 0.5); }
        
        /* ÙÚ•Û†Ú©Û•ÛŒ Ø¬ÙˆÚµØ§Ùˆ */
        #plane { position: absolute; width: 100px; z-index: 20; transform: translate(-50%, -50%); transition: 0.1s linear; }
        
        .control-panel { background: var(--panel); padding: 30px; border-radius: 40px 40px 0 0; display: flex; flex-direction: column; gap: 15px; align-items: center; }
        .bet-btn { width: 90%; padding: 20px; border-radius: 15px; border: none; font-size: 24px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-green { background: #28a745; color: white; box-shadow: 0 6px #1e7e34; }
        .btn-red { background: var(--main-red); color: white; box-shadow: 0 6px #b11243; }
        
        canvas { position: absolute; top: 0; left: 0; }
    </style>
</head>
<body>

<div class="game-wrapper">
    <div class="header">
        <div style="font-weight: 900; color: var(--main-red);">AVIATRIX PRO</div>
        <div id="balance">ğŸ’° 0 IQD</div>
    </div>

    <div class="main-stage" id="stage">
        <canvas id="chartCanvas"></canvas>
        <div id="multiplier">1.00x</div>
        <img id="plane" src="https://aviator-game.in/wp-content/uploads/2023/02/aviator-plane.png" style="display:none;">
        <div id="plane-emoji" style="position:absolute; font-size:50px;">âœˆï¸</div>
    </div>

    <div class="control-panel">
        <div style="display:flex; gap:10px;">
            <input type="number" id="betInput" value="1000" style="padding:15px; border-radius:10px; background:#000; color:#fff; border:1px solid #444; width:150px; text-align:center; font-size:20px;">
        </div>
        <button id="mainBtn" class="bet-btn btn-green" onclick="handleAction()">BET</button>
    </div>
</div>

<script>
    // Ù„ÛØ±Û•Ø¯Ø§ Ú©Û†Ù†ÙÛÚ¯ÛŒ ÙØ§ÛŒÛ•Ø±Ø¨Û•ÛŒØ³Û•Ú©Û•Øª Ø¯Ø§Ø¨Ù†Û...
    const firebaseConfig = {
        apiKey: "AIzaSyDCwv_kg1O3kiV4qkQjZnZHEWCrOMCH6W4",
        authDomain: "kurdex-pro-fa38c.firebaseapp.com",
        projectId: "kurdex-pro-fa38c",
        storageBucket: "kurdex-pro-fa38c.firebasestorage.app",
        messagingSenderId: "900983839878",
        appId: "1:900983839878:web:b445bdf15aebb1a0d68507"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();

    let balance = 0;
    let isPlaying = false;
    let currentX = 1.00;
    let gameLoop;
    let points = [];
    const canvas = document.getElementById('chartCanvas');
    const ctx = canvas.getContext('2d');

    // Ù†ÙˆÛÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ Ù‚Û•Ø¨Ø§Ø±Û•ÛŒ Ú©Ø§Ù†Ú¤Ø§Ø³
    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = document.getElementById('stage').offsetHeight;
    }
    window.onresize = resize;
    resize();

    auth.onAuthStateChanged(user => {
        if (user) {
            db.collection("wallets").doc(user.uid).onSnapshot(doc => {
                balance = doc.data().balance;
                document.getElementById('balance').innerText = "ğŸ’° " + balance.toLocaleString() + " IQD";
            });
        }
    });

    function handleAction() {
        const btn = document.getElementById('mainBtn');
        const bet = Number(document.getElementById('betInput').value);

        if(!isPlaying) {
            if(bet > balance) { alert("Ø¨Ø§ÚµØ§Ù†Ø³Øª Ø¨Û•Ø´ Ù†Ø§Ú©Ø§Øª!"); return; }
            startFlight(bet);
        } else {
            cashOut(bet);
        }
    }

    function startFlight(bet) {
        isPlaying = true;
        currentX = 1.00;
        points = [];
        balance -= bet;
        updateDB();

        const btn = document.getElementById('mainBtn');
        btn.innerText = "CASH OUT";
        btn.className = "bet-btn btn-red";

        let crashAt = (Math.random() * 5 + 1.1).toFixed(2);

        gameLoop = setInterval(() => {
            currentX += 0.01;
            document.getElementById('multiplier').innerText = currentX.toFixed(2) + "x";

            // Ø¬ÙˆÚµÛ•ÛŒ ÙÚ•Û†Ú©Û• Ùˆ Ú©ÛØ´Ø§Ù†ÛŒ Ú¯Ø±Ø§Ù
            let x = (currentX - 1) * (canvas.width / 4);
            let y = canvas.height - ((currentX - 1) * (canvas.height / 3.5)) - 100;
            points.push({x, y});

            drawScene();
            
            let p = document.getElementById('plane-emoji');
            p.style.left = x + "px";
            p.style.top = y + "px";

            if(currentX >= crashAt) { finishGame("CRASHED! ğŸ’¥", true); }
        }, 60);
    }

    function drawScene() {
        ctx.clearRect(0,0, canvas.width, canvas.height);
        ctx.beginPath();
        ctx.strokeStyle = "#ea1d5d";
        ctx.lineWidth = 8;
        ctx.lineJoin = "round";
        ctx.shadowBlur = 15;
        ctx.shadowColor = "#ea1d5d";
        
        for(let i=0; i<points.length; i++){
            if(i===0) ctx.moveTo(points[i].x, points[i].y);
            else ctx.lineTo(points[i].x, points[i].y);
        }
        ctx.stroke();
    }

    function cashOut(bet) {
        balance += Math.floor(bet * currentX);
        updateDB();
        finishGame("Ù¾ÛŒØ±Û†Ø²Û•! Ù¾Ø§Ø±Û•Ú©Û•Øª Ø¨Ø±Ø¯Û•ÙˆÛ• ğŸš€", false);
    }

    function finishGame(msg, crashed) {
        clearInterval(gameLoop);
        isPlaying = false;
        alert(msg);
        const btn = document.getElementById('mainBtn');
        btn.innerText = "BET";
        btn.className = "bet-btn btn-green";
    }

    function updateDB() {
        const user = auth.currentUser;
        if(user) db.collection("wallets").doc(user.uid).update({balance});
    }
</script>

</body>
</html>
